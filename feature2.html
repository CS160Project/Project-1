<!--Feature 2 Search by Location HTML File-->
<!--Created By: Kai - Ting(Danil) Ko      -->
<!--Modified By: None                     -->
<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title></title>
        <!--Need to load google api in order to use Google Map Autocomplete API-->
        <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=places"></script>
        <script>
            // initialize
            // Input: None
            // Output: None
            // The intialize function that will be called after intial script loading complete
            // The function will create autocomplete objects to help user to input locations
            // The objects will attch listeners, so when user click on one of autocomplete opinions
            // The latitude and longitude for the location will be filled into the hidden field
            function initialize() {
                // Create object reference to the input origin location
                var lOriginInput = document.getElementById('originTextField');
                // Create the autocomplete for the input origin location
                var lOriginAutocomplete = new google.maps.places.Autocomplete(lOriginInput);

                // Add listener to the autcomplete
                // Once the user click on one of autocomplete opinions, the latitude and longitude
                // for the location will be filled into the hidden field 
                google.maps.event.addListener(lOriginAutocomplete, 'place_changed',
                function () {
                    // Set the origin input as none
                    lOriginInput.className = '';
                    // Retrive the location based on the current autcomplete
                    var lPlace = lOriginAutocomplete.getPlace();
                    // If the returned place is not on the map, stop performing the process
                    if (!lPlace.geometry) {
                        lOriginInput.className = 'not found';
                        return;
                    }  // if
                    // If the location is valid, set the longitude and latitude to the hidden fields
                    var lLocation = lPlace.geometry.location;
                    document.getElementById('originLatitudeTextField').value = lLocation.lat();
                    document.getElementById('originLongitudeTextField').value = lLocation.lng();
                }  // lambda function
                );  // google.maps.event.addListener

                // Create object reference to the input destination location
                var lDestinationInput = document.getElementById('destinationTextField');
                var lDestinationAutocomplete = new google.maps.places.Autocomplete(lDestinationInput);

                // Add listener to the autcomplete
                // Once the user click on one of autocomplete opinions, the latitude and longitude
                // for the location will be filled into the hidden field 
                google.maps.event.addListener(lDestinationAutocomplete, 'place_changed',
                function () {
                    // Set the destination input as none
                    lDestinationInput.className = '';
                    // Retrive the location based on the current autcomplete
                    var lPlace = lDestinationAutocomplete.getPlace();
                    // If the returned place is not on the map, stop performing the process
                    if (!lPlace.geometry) {
                        lDestinationInput.className = 'not found';
                        return;
                    }  // if
                    // If the location is valid, set the longitude and latitude to the hidden fields
                    var lLocation = lPlace.geometry.location;
                    document.getElementById('destinationLatitudeTextField').value = lLocation.lat();
                    document.getElementById('destinationLongitudeTextField').value = lLocation.lng();
                }  // lambda function
                );  // google.maps.event.addListener
            }  // function initialize()

            // Set the google map event listener to start to active once the load function completes and call initialize function
            google.maps.event.addDomListener(window, 'load', initialize);
        </script>
    </head>
    <body>
        <!--Setting up form for input prameters-->
        <form method="post" action="./feature2.php">
            <p>Origin Location</p>
             <!--The input for user to type in the origin location and associated with Google Map Autocomplete API-->
            <input name ="originTextField" id="originTextField" type="text" size="50">
             <!--Need two hidden fields to store the latitude and longitude for the user input location based on Google Map Autocomplete API-->
            <input name ="originLatitudeTextField" id="originLatitudeTextField" type="hidden" size="50">
            <input name ="originLongitudeTextField" id="originLongitudeTextField" type="hidden" size="50">
            <p>Destination Location</p>
            <!--The input for user to type in the destination location and associated with google autocomplete API-->
            <input name ="destinationTextField" id="destinationTextField" type="text" size="50">
            <!--Need two hidden fields to store the latitude and longitude for the user input location based on Google Map Autocomplete API-->
            <input name ="destinationLatitudeTextField" id="destinationLatitudeTextField" type="hidden" size="50">
            <input name ="destinationLongitudeTextField" id="destinationLongitudeTextField" type="hidden" size="50">
            <input type="submit" value="Submit" onclick="">
        </form>
    </body>
</html>
